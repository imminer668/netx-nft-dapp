(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5557:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(3837)}])},3837:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return m}});var a=t(5893),i=t(7294),s=t(6318),r=t(1376),p=t(8470),d=t(7583);let l="0x87CC9C79FD7Db3C7Ead9758153725DBeD65F3939",u=[{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"value",type:"uint256"}],name:"approve",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"initialOwner",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"allowance",type:"uint256"},{internalType:"uint256",name:"needed",type:"uint256"}],name:"ERC20InsufficientAllowance",type:"error"},{inputs:[{internalType:"address",name:"sender",type:"address"},{internalType:"uint256",name:"balance",type:"uint256"},{internalType:"uint256",name:"needed",type:"uint256"}],name:"ERC20InsufficientBalance",type:"error"},{inputs:[{internalType:"address",name:"approver",type:"address"}],name:"ERC20InvalidApprover",type:"error"},{inputs:[{internalType:"address",name:"receiver",type:"address"}],name:"ERC20InvalidReceiver",type:"error"},{inputs:[{internalType:"address",name:"sender",type:"address"}],name:"ERC20InvalidSender",type:"error"},{inputs:[{internalType:"address",name:"spender",type:"address"}],name:"ERC20InvalidSpender",type:"error"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"mint",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"OwnableInvalidOwner",type:"error"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"OwnableUnauthorizedAccount",type:"error"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"spender",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"}],name:"transfer",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Transfer",type:"event"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"}],name:"transferFrom",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"transferWithCallback",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"bytes",name:"tokenId",type:"bytes"}],name:"transferWithCallbackBuyNFT",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"spender",type:"address"}],name:"allowance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"decimals",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"}],y=[{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"approve",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"initialOwner",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[{internalType:"address",name:"sender",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"address",name:"owner",type:"address"}],name:"ERC721IncorrectOwner",type:"error"},{inputs:[{internalType:"address",name:"operator",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"ERC721InsufficientApproval",type:"error"},{inputs:[{internalType:"address",name:"approver",type:"address"}],name:"ERC721InvalidApprover",type:"error"},{inputs:[{internalType:"address",name:"operator",type:"address"}],name:"ERC721InvalidOperator",type:"error"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"ERC721InvalidOwner",type:"error"},{inputs:[{internalType:"address",name:"receiver",type:"address"}],name:"ERC721InvalidReceiver",type:"error"},{inputs:[{internalType:"address",name:"sender",type:"address"}],name:"ERC721InvalidSender",type:"error"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"ERC721NonexistentToken",type:"error"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"OwnableInvalidOwner",type:"error"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"OwnableUnauthorizedAccount",type:"error"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"approved",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"operator",type:"address"},{indexed:!1,internalType:"bool",name:"approved",type:"bool"}],name:"ApprovalForAll",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"_fromTokenId",type:"uint256"},{indexed:!1,internalType:"uint256",name:"_toTokenId",type:"uint256"}],name:"BatchMetadataUpdate",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"_tokenId",type:"uint256"}],name:"MetadataUpdate",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"string",name:"uri",type:"string"}],name:"safeMint",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"safeTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"bytes",name:"data",type:"bytes"}],name:"safeTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"operator",type:"address"},{internalType:"bool",name:"approved",type:"bool"}],name:"setApprovalForAll",outputs:[],stateMutability:"nonpayable",type:"function"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Transfer",type:"event"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"transferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"getApproved",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"operator",type:"address"}],name:"isApprovedForAll",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"ownerOf",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes4",name:"interfaceId",type:"bytes4"}],name:"supportsInterface",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"tokenURI",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"}],o=[{inputs:[{internalType:"address",name:"_owner",type:"address"},{internalType:"address",name:"token",type:"address"},{internalType:"address",name:"nft",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[{internalType:"address",name:"target",type:"address"}],name:"AddressEmptyCode",type:"error"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"AddressInsufficientBalance",type:"error"},{inputs:[{internalType:"uint256",name:"eth",type:"uint256"}],name:"AmountTooLow",type:"error"},{inputs:[],name:"FailedInnerCall",type:"error"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"OwnableInvalidOwner",type:"error"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"OwnableUnauthorizedAccount",type:"error"},{inputs:[{internalType:"address",name:"token",type:"address"}],name:"SafeERC20FailedOperation",type:"error"},{inputs:[{internalType:"address",name:"_owner",type:"address"}],name:"invalidAddress",type:"error"},{inputs:[{internalType:"address",name:"_address",type:"address"}],name:"transferFailed",type:"error"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"listingId",type:"uint256"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!0,internalType:"address",name:"seller",type:"address"},{indexed:!1,internalType:"uint256",name:"price",type:"uint256"}],name:"NFTListed",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"listingId",type:"uint256"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!0,internalType:"address",name:"buyer",type:"address"},{indexed:!1,internalType:"uint256",name:"price",type:"uint256"}],name:"NFTSold",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"_address",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"WthdrawEthEvent",type:"event"},{inputs:[{internalType:"uint256",name:"_listingId",type:"uint256"},{internalType:"uint256",name:"_price",type:"uint256"}],name:"buyNFT",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"erc20Contract",outputs:[{internalType:"contract IERC20",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getActiveListings",outputs:[{components:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"address",name:"seller",type:"address"},{internalType:"uint256",name:"price",type:"uint256"},{internalType:"bool",name:"active",type:"bool"}],internalType:"struct NFTMarket.Listing[]",name:"",type:"tuple[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_tokenId",type:"uint256"},{internalType:"uint256",name:"_price",type:"uint256"}],name:"listNFT",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"listings",outputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"address",name:"seller",type:"address"},{internalType:"uint256",name:"price",type:"uint256"},{internalType:"bool",name:"active",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"nftContract",outputs:[{internalType:"contract IERC721",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address payable",name:"_recipient",type:"address"},{internalType:"uint256",name:"_amount",type:"uint256"}],name:"withdrawEth",outputs:[],stateMutability:"nonpayable",type:"function"},{stateMutability:"payable",type:"receive"}];function m(){let[e,n]=(0,i.useState)([]),[t,m]=(0,i.useState)(""),[c,T]=(0,i.useState)(""),[w,b]=(0,i.useState)(""),[f,v]=(0,i.useState)(""),[h,g]=(0,i.useState)(0),x=(0,i.useRef)(null),M=(0,i.useRef)(null),I=(0,i.useRef)(null),k=(0,i.useRef)(0),C=async()=>{let e=null,n=null;if(null==window.ethereum?(console.log("MetaMask not installed; using read-only defaults"),e=s.y()):(e=new r.Q(window.ethereum),n=await e.getSigner()),n){e.getNetwork().then(e=>{b(e.name)}).catch(e=>{console.error(e)});let n=await e.listAccounts();if(n.length>0){let t=n[0].address;m(t),I.current=t,await e.send("eth_requestAccounts",[]);let a=await e.getBalance(t);T(p.dF(a))}else m("")}},O=async()=>{let e=null;null==window.ethereum?(console.log("MetaMask not installed; using read-only defaults"),e=s.y()):(e=new r.Q(window.ethereum),await e.getSigner());let t=new d.CH(l,o,e),a=await t.getActiveListings(),i=[];for(let e=0;e<a.length;e++)i.push({tokenId:a[e].tokenId.toString(),seller:a[e].seller.toString(),price:a[e].price.toString(),active:a[e].active,image:await F(a[e].tokenId.toString())});n(i)},E=async()=>{let e=null,n=null;null==window.ethereum?(console.log("MetaMask not installed; using read-only defaults"),e=s.y()):(e=new r.Q(window.ethereum),n=await e.getSigner());let t=x.current.value,a=M.current.value;if(null!==t&&""!==t&&null!==a&&""!==a){let e=new d.CH(l,o,n);await e.listNFT(t,a).then(e=>{alert("上架成功了"),x.current.value="",M.current.value="",console.log("成功==",e),window.location.reload()}).catch(e=>{alert("上架失败了"),console.log("失敗~",e),console.log("失敗=",e.message)})}},F=async e=>{let n=null;null==window.ethereum?(console.log("MetaMask not installed; using read-only defaults"),n=s.y()):(n=new r.Q(window.ethereum),await n.getSigner());let t=new d.CH("0x07e78981244CD43971960cDDe344a411FA60f128",y,n),a=await t.tokenURI(e),i=await fetch(a);return(await i.json()).image},A=async(e,n)=>{let t=null,a=null;null==window.ethereum?(console.log("MetaMask not installed; using read-only defaults"),t=s.y()):(t=new r.Q(window.ethereum),a=await t.getSigner());let i=new d.CH(l,o,a);console.log("tokenID:"+e),console.log("price:"+n),await i.buyNFT(e,n).then(e=>{alert("购买成功了"),x.current.value="",M.current.value="",console.log("成功==",e),window.location.reload()}).catch(e=>{alert("购买失败了"),console.log("失敗~",e),console.log("失敗=",e.message)})},_=async()=>{let e=null;null==window.ethereum?(console.log("MetaMask not installed; using read-only defaults"),e=s.y()):(e=new r.Q(window.ethereum),await e.getSigner());let n=new d.CH("0x91346d3E393dBC682054BB814caCE12e394A42A6",u,e),t=await n.symbol(),a=await n.balanceOf(I.current);g(a.toString()),v(t),k.current=a,console.log("tokenName=="+t),console.log("tokenBalance=="+a)};return(0,i.useEffect)(()=>{let e=e=>{e.length>0?m(e[0]):m("")},n=e=>{b(e)};return window.ethereum.on("accountsChanged",e),window.ethereum.on("chainChanged",n),C().then(e=>{_()}),O(),()=>{window.ethereum.off("accountsChanged",e),window.ethereum.off("chainChanged",n)}},[]),(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"container",children:[(0,a.jsxs)("div",{className:"account-info",children:[(0,a.jsxs)("p",{children:["当前账户的地址: ",t]}),(0,a.jsxs)("p",{children:["ETH余额: ",c,"ETH"]}),(0,a.jsxs)("p",{children:["当前区块链网络: ",w]}),(0,a.jsxs)("p",{children:["TokenName: ",(0,a.jsxs)("label",{children:["“",f,"”"]}),"余额 :"," ",h]})]}),(0,a.jsxs)("div",{className:"nft-listing",children:[(0,a.jsx)("label",{htmlFor:"tokenID",children:"TokenID"}),(0,a.jsx)("input",{ref:x,type:"text",id:"tokenID",name:"tokenID"}),(0,a.jsx)("label",{htmlFor:"price",children:"Price:"}),(0,a.jsx)("input",{id:"price",ref:M,type:"text",name:"price"}),"FF",(0,a.jsx)("button",{onClick:E,children:"LIST 上架"})]}),(0,a.jsxs)("div",{className:"nft-list",children:[(0,a.jsx)("p",{children:"已上架的NFT"}),e.map(e=>(0,a.jsxs)("ul",{children:[(0,a.jsxs)("li",{children:["tokenID: ",e.tokenId]}),(0,a.jsxs)("li",{children:["price: ",e.price," FF"]}),(0,a.jsxs)("li",{children:["sellerAddress: ",e.seller]}),(0,a.jsx)("li",{children:(0,a.jsx)("img",{width:211,height:230,src:e.image,alt:"nft"})}),(0,a.jsx)("li",{children:(0,a.jsx)("button",{onClick:()=>A(e.tokenId,e.price),children:"BUY 购买"})})]},e.tokenId))]})]})})}}},function(e){e.O(0,[851,888,774,179],function(){return e(e.s=5557)}),_N_E=e.O()}]);